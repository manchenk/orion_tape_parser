Скрипт orion_tape_parser.rb предназначен для автоматического парсинга оцифрованных записей на магнитную ленту, созданных ПК "Орион-128" и "Радио-86РК". Формат входного файла - WAV, рекомендуемая частота дискретизации - 44100Гц. Скрипт автоматически определяет преамбулу записи и вычисляет константу чтения, далее данные считываются до потери синхронизации. Полученный битовый поток анализируется и определяется формат файла ("Орион" или "Радио"), далее проверяется размер, контрольнуая сумма файла и соответственно сохраняются данные в формате BRU или RK. Затем процесс повторяется до достижения конца файла. При анализе в стандартный вывод выводится полная информация о битовом потоке


Пример анализа битового потока:
```
********************************************************************************
Preamble found at sample: 61642907, pulse index: 2083273 (3f939+1)                - номер выборки WAV файла, где найдена преамбула
        pulses: 2083265: 15 25 15 22 16 22 15 23 15 22 16 22 16 21 17 21          - длительности импульсов (по количеству выборок) в этом месте WAV файла
Sync lost at sample: 65655632, pulse index: 2263183 (45111+7)                     - номер выборки WAV файла, где потеряна синхронизация
        pulses: 2263175: 18 19 37 38 37 20 18 20 227 1105 2193 2359 10 12 10 51   - длительности импульсов (по количеству выборок) в этом месте WAV файла
Statistic:
        stream length, bits:    103360 (3278+0)                                   - размер битового потока (размер в байтах)
        average pulse diration: 19.0 (210746)                                     - средняя длительность импулься (общее количество)
        short pulses:                                                             - статистика по длительности коротких импульсов
                average duration,      [11.4] 14 < 19.0 < 25 [26.7] (149138)      - допустимые пределы и реальные длительности коротких импульсов (их количество) 
                duration distribution: 14:2 15:9 16:120 17:9959 18:43295 19:60858 20:23823 21:2187 22:4791 23:3818 24:274 25:1  - распределение длительности импульсов
                duratuin dispersion:   1.5                                        - дисперсия длительности коротких импульсов
        long pulses:                                                              - статистика по длительности длинных импульсов
                average duration:      [30.5] 36 < 38.4 < 43 [45.7] (30804)       - допустимые пределы и реальные длительности коротких импульсов (их количество)
                duration distribution: 36:44 37:4202 38:16046 39:6775 40:946 41:2003 42:766 43:22      - распределение длительности импульсов
                duration dispersion:   1.3                                        - дисперсия длительности длинных импульсов
File info:
        result: ok                             - реультат анализа битового потока
        name:   #TETRIS$                       - имя файла из заголовка
        base:   0000-3220                      - начальный и конечный адреса загрузки файла в пямять
        length: 3221                           - размер файла
        CRC:    f334 (read) -> f334 (calc)     - контрольные суммы (счинанная и вычисленная)
```
Далее следует дамп файла. 

Если в процессе анализа возникают ошибки, то файл не сохраняется, а в лог записывается полный дамп битового потока (с байтами синхронизации, преамбулами и контрольными суммами). Если сбой проиходит по причине выпадения бита (импульсная помеха на магнитной ленте), то это место можно найти в редакторе WAV файла по номеру выборки потери синхронизации и попытаться его исправить. Таким образом можно восстановить испорченные записи. Если запись стереофоническая моно попытаться считать данные с другого канала, либо обрабатывать среднее зачение двух каналов (опция -c both).

Параметры вызова скрипта:
```
Usage: orion_tape_parser.rb [options]
    -c, --channel=CHANNEL            Канал чтения данных (если WAV файл содержит 2 канала) (left (default), right, both)
    -d, --delta=N                    Допустимый интервал девиации длительности имульса в процентах (default 40%)
    -t, --tone=N                     Минимальное количество импульсов одинаковой длительности для определения преамбулы (default 32, 2 byte)
    -f, --file=FILE                  Имя входного WAV файла
    -h, --help                       Вывод помощи
```
